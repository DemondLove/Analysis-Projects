---
title: "Demond Love DSC 520 Assignment 4.1 Student Survey"
author: "Demond Love"
date: "6/30/2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

**As a data science intern with newly learned knowledge in skills in statistical correlation and R programming, you will analyze the results of a survey recently given to college students. You learn that the research question being investigated is: “Is there a significant relationship between the amount of time spent reading and the time spent watching television?” You are also interested if there are other significant relationships that can be discovered? The survey data is located in this StudentSurvey.csv file.**

```{r, results='hide', warning = FALSE, message = FALSE}
library(ggplot2)
library(readr)
library(pastecs)
library(ggm)

file = read_csv('~/Documents/DSC 520 Statistics for Data Science/Week 4 DSC 520/student-survey.csv')
```
```{r}
file
```

**a. Use R to calculate the covariance of the Survey variables and provide an explanation of why you would use this calculation and what the results indicate.**

```{r}
cov(file)
```

Covariance is a measure of the 'average' relationship between two variables. It is the average cross-product deviation. If we assume that two variables are related, then we can use covariance to measure the validity of our expectation; since when one variable deviates from its mean, then we would expect the other variable to deviate from its mean in a similar way.

**b. Examine the Survey data variables. What measurement is being used for the variables? Explain what effect changing the measurement being used for the variables would have on the covariance calculation. Would this be a problem? Explain and provide a better alternative if needed.**

TimeReading is measuring the amount of time a student is spending reading, with a unit of measurement of hours. TimeTV is measiring the amount of time a student is spending watching TV, with a unit of measurement of minutes. Happiness is measuring the amount of happiness each student feels, on a scale of 1 to 100. Gender is a binary variable, with 1 representing one gender and 0 representing the other.

There are a few issues with the units of measurement being used. First, that TimeReading are all whole numbers, so these are presumably being rounded to the nearest integer. Whereas TimeTV are not represented in multiples of 60. Lastly, it is unclear which gender is assigned to which binary variable. Therefore, we will not be able to do any meaningful analysis comparing males to females on these dimensions.

The obvious transformation would be to convert TimeReading to minutes, and rerunning the covariance calculations.

```{r}
transfile = data.frame(file$TimeReading*60, file$TimeTV, file$Happiness, file$Gender)
names(transfile) = c("TimeReading", "TimeTV", "Happiness", "Gender")

transfile
```

```{r}
cov(transfile)
```

Here, you can see that the covariance values have changed. This does expose a problem with covariance. It depends upon the scales of measurement used, which is why covariance is not a standardized measure. Therefore, this second measurement is a more accuate measure of the relationship of TimeTv and TimeReading.

**c. Choose the type of correlation test to perform, explain why you chose this test, and make a prediction if the test yields a positive or negative correlation?**

```{r}
ggplot(transfile, aes(TimeReading)) + geom_histogram()
```

```{r}
round(stat.desc(transfile$TimeReading, basic = FALSE, norm = TRUE), digits = 3)
```


```{r}
ggplot(transfile, aes(TimeTV)) + geom_histogram()
```
```{r}
round(stat.desc(transfile$TimeTV, basic = FALSE, norm = TRUE), digits = 3)
```

I have chosen to use the Pearson correlation coefficient because the underlying data meets the assumptions of Pearson's correlation coefficient. Namely that the variables TimeReading and TimeTV are both normally distributed interval variables. If skew.2SE or kurt.2SE are greater than 1 (ignoring the plus or minus sign) then you have significant skew/kurtosis. However, in neither of the above distributions is this significance level met. Therefore, our z-scores do not dictate that our skewness or kurtosis are statistically significant.

**d. Perform a correlation analysis of:**

**1. All variables**

```{r}
cor(transfile)
```


**2. A single correlation between two a pair of the variables**
```{r}
cor(transfile$TimeReading, transfile$TimeTV)
```

**3. Repeat your correlation test in step 2 but set the confidence interval at 99%**
```{r}
cor.test(transfile$TimeReading, transfile$TimeTV, method = 'pearson', conf.level = 0.99)
```


**4. Describe what the calculations in the correlation matrix suggest about the relationship between the variables. Be specific with your explanation.**

```{r}
cor(transfile)
```

The correlation coefficients in the above matrix above can range between -1 and 1, with higher positive numbers meaning a closer relationship between the two variables, lower negative numbers meaning an inverse relationship and numbers near zero meaning no relationship.

There are really 3 figures that are most interesting in the dataset. The relationships of TimeReading and TimeTv, the relationship of TimeReading and Happiness, then lastly the relationship of TimeTV and Happiness.

TimeReading and TimeTv have a high negative value of -.88, which implies a strong inverse relationship. Meaning that the more someone reads, then the less television that they read on average. And vice versa.

Interestingly, TimeReading and Happiness have a moderate negative value of -.43, which implies a moderate inverse relationship. Meaning that the more someone reads, then the less happy that they are on average. And vice versa.

Aso, surprisingly, TimeTV and Happiness have a moderate positive value of .64, which implies a moderate positive relationship. Meaning that the more someone watches TV, then the happier that they are on average. And vice versa.

**e. Calculate the correlation coefficient and the coefficient of determination, describe what you conclude about the results.**

```{r}
cor(transfile)
```

```{r}
cor(transfile)^2*100
```

As opposed to the correlation coefficient, described earlier, the coefficient of determination is a measure of the amount of variablility in one variable that is shared by others.

From this, you can see that 80% of the variance in TimeReading is accounted for by TimeTV. 19% of the variance in Happiness is accounted for by TimeReading. 41% of the variance in Happiness is accounted for by TimeTV.

**f. Based on your analysis can you say that watching more TV caused students to read less? Explain.**

No, correlation doesn't imply causation.

**g. Pick three variables and perform a partial correlation, documenting which variable you are “controlling”. Explain how this changes your interpretation and explanation of the results.**

I have chosen to perform a partial correlation on TimeReading and Happiness, while controlling for TimeTV.

```{r}
pc = pcor(c("Happiness", "TimeReading", "TimeTV"), var(transfile))
pc
```

```{r}
pcor.test(pc, 1, 11)
```

Whereas previously the correlation coefficient between Happiness and TimeReading was -.43; when controlling for the time spent watching TV, the correlation coefficient becomes 0.35. Although its relationship has improved, this isn't statisitcally significant (its p-value of .32 is quite a bit higher than the .05 confidence interval).

**Include all of your answers in a R Markdown report.**